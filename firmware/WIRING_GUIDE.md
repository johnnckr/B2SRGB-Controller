# 🔌 คู่มือการเชื่อมสาย LED Strip กับ ESP32

## 📋 อุปกรณ์ที่ต้องใช้

### ฮาร์ดแวร์:
- ✅ **ESP32** (ทุกรุ่น - NodeMCU, DevKit, WROOM, WROVER)
- ✅ **LED Strip WS2812B** (หรือ WS2811, SK6812, APA102)
- ✅ **Power Supply 5V DC** (กำลังวัตต์ตามจำนวน LED)
- ✅ **สายไฟ** (AWG 18-22 สำหรับไฟเลี้ยง, AWG 24-26 สำหรับ Data)
- ✅ **Capacitor 1000µF 6.3V** (ป้องกันไฟกระชาก)
- ✅ **Resistor 330Ω - 470Ω** (ป้องกัน Data Pin)

---

## 🔌 การเชื่อมต่อแบบมาตรฐาน

### วงจรพื้นฐาน:

```
                    ┌─────────────┐
                    │   Power     │
                    │   Supply    │
                    │   5V DC     │
                    └──┬──────┬───┘
                       │      │
                    +5V│      │GND
                       │      │
    ┌──────────────────┼──────┼────────────────┐
    │  ESP32           │      │                │
    │                  │      │                │
    │         GPIO 5 ──┼──────┼────> DIN       │
    │         (Data)   │      │     (Data In)  │
    │                  │      │                │
    │            GND ──┼──────┼────> GND       │
    │                  │      │                │
    │            VIN ──┘      └────> 5V        │
    │           (5V)                 (Power)   │
    └──────────────────────────────────────────┘
                LED Strip (WS2812B)
```

---

## 📐 การเชื่อมต่อแบบละเอียด

### ขั้นตอนที่ 1: เตรียม LED Strip

LED Strip จะมี 3 สายหลัก:
- 🔴 **5V / VCC / +** - สายไฟบวก (สีแดง)
- ⚫ **GND / -** - สายไฟลบ (สีขาว/ดำ)
- 🟢 **DIN / Data In** - สายข้อมูล (สีเขียว)

> ⚠️ **สำคัญ**: มี **ทิศทาง** ของ LED Strip (ดูลูกศรบน Strip)
> - **DIN** = Data Input (ต้นทาง)
> - **DOUT** = Data Output (ปลายทาง)
> - ต่อเฉพาะฝั่ง **DIN** เท่านั้น!

---

### ขั้นตอนที่ 2: เชื่อมต่อ Power Supply

```
Power Supply 5V
├─ Terminal (+) ──┐
│                 ├─ LED Strip 5V (สายแดง)
│                 └─ Capacitor 1000µF (+) ───┐
│                                             │
└─ Terminal (-)   ┐                           │
                  ├─ LED Strip GND (สายดำ)   │
                  ├─ Capacitor 1000µF (-)    │
                  └─ ESP32 GND               │
                                              │
        ESP32 GND ────────────────────────────┘
```

**หมายเหตุ:**
1. ต่อ **Capacitor 1000µF** ขนานกับสายไฟเพื่อลดไฟกระชาก
2. ต้องต่อ **GND ของ ESP32** เข้ากับ **GND ของ Power Supply** (กราวด์ร่วม)
3. **ห้าม** ต่อไฟ 5V ของ LED เข้ากับ ESP32 โดยตรง (ไฟไหม้ได้!)

---

### ขั้นตอนที่ 3: เชื่อมต่อ Data Pin

```
ESP32 GPIO 5 ──┬─ Resistor 330Ω ──┬─ LED Strip DIN (สายเขียว)
               │                   │
               │                   └─ Capacitor 100nF (optional)
               │                      to GND
               └───────────────────────(ระยะ < 30cm)
```

**เทคนิคสำคัญ:**
1. ใส่ **Resistor 330-470Ω** ระหว่าง GPIO กับ DIN (ป้องกันไฟกระชาก)
2. ถ้าสาย Data ยาวเกิน 30cm ควรใส่ Capacitor 100nF ที่ต้น LED Strip
3. ใช้สาย Data ที่สั้นที่สุดเท่าที่จะเป็นไปได้

---

## 🎨 ตัวอย่างการเชื่อมต่อจริง

### แบบที่ 1: LED Strip สั้นๆ (< 60 LEDs)

```
┌─────────────────────────────────────────────┐
│                                             │
│  USB Cable                                  │
│  (ไฟจากคอมพิวเตอร์)                         │
│     │                                       │
│     ↓                                       │
│  ┌─────────┐                                │
│  │  ESP32  │                                │
│  │         │                                │
│  │ GPIO 5 ─┼─ 330Ω ──────> DIN              │
│  │         │              (สายเขียว)        │
│  │  GND ───┼──────────────> GND             │
│  │         │              (สายดำ)           │
│  │  VIN ───┼──────────────> 5V              │
│  │  (5V)   │              (สายแดง)          │
│  └─────────┘                                │
│                        LED Strip            │
│                        (< 60 LEDs)          │
└─────────────────────────────────────────────┘
```

> ⚠️ **เหมาะสำหรับ**: LED ไม่เกิน 60 ดวง (กินไฟ ~3.6W)

---

### แบบที่ 2: LED Strip ขนาดใหญ่ (> 60 LEDs) - **แนะนำ**

```
┌────────────────────────────────────────────────────────┐
│                                                        │
│  [Power Supply 5V 10A]                                │
│     (+)  (-)                                          │
│      │    │                                           │
│      │    │   ┌────────┐  1000µF                      │
│      │    │   │ ESP32  │  ═══                         │
│      │    │   │        │   │                          │
│      │    │   │ GPIO 5 ├─ 470Ω ──> DIN (เขียว)       │
│      │    │   │        │            │                 │
│      │    └───│  GND   ├────────────┼──> GND (ดำ)    │
│      │        │        │            │                 │
│      └────────│  VIN   │            │                 │
│               └────────┘            │                 │
│                  │                  │                 │
│                  │ (USB สำหรับ     │                 │
│                  │  โปรแกรม        │                 │
│                  │  เท่านั้น)      │                 │
│                  │                  │                 │
│              ┌───┴──────────────────┴───┐             │
│              │    LED Strip WS2812B     │             │
│              │  (300 LEDs ใช้ 5V 18W)  │             │
│              └──────────────────────────┘             │
│                                                        │
└────────────────────────────────────────────────────────┘
```

**สูตรคำนวณ Power Supply:**
```
กระแส (A) = จำนวน LED × 0.06A
วัตต์ (W) = จำนวน LED × 0.3W

ตัวอย่าง:
- 100 LEDs = 6A × 5V = 30W → ใช้ Power Supply 5V 10A
- 300 LEDs = 18A × 5V = 90W → ใช้ Power Supply 5V 20A
- 1200 LEDs = 72A × 5V = 360W → ใช้ Power Supply 5V 80A
```

> 💡 **เคล็ดลับ**: ซื้อ Power Supply ที่มีกำลังวัตต์มากกว่าที่คำนวณได้ 20-30%

---

## 🔧 การเชื่อมต่อแบบหลาย Segment

### สำหรับ LED Strip ยาวมากๆ (> 300 LEDs)

แนะนำให้ **แบ่งไฟเลี้ยง** ทุกๆ 150-300 LEDs:

```
            ESP32
              │
        GPIO 5│ (Data)
              │
        ┌─────┴─────┐
        │           │
     ┌──▼──┐     ┌──▼──┐     ┌──────┐
     │ 5V  │     │ 5V  │     │ 5V   │
     │ GND │     │ GND │     │ GND  │
     │ DIN │─────│DOUT │─────│ DIN  │
     └─────┘     └─────┘     └──────┘
      150 LEDs    150 LEDs    150 LEDs
        ↑           ↑            ↑
        │           │            │
     [Power]     [Power]     [Power]
     5V 10A      5V 10A      5V 10A
```

**วิธีการ:**
1. ต่อ Data แบบอนุกรม (DIN → DOUT → DIN)
2. แต่ละ segment ต่อไฟ 5V แยกกัน (Parallel Power)
3. GND ต้องต่อร่วมกันทั้งหมด

---

## 🎯 การทดสอบ

### Test 1: ทดสอบไฟเลี้ยง
```
1. ต่อเฉพาะ 5V และ GND (ยังไม่ต่อ Data)
2. เปิดไฟ
3. LED ควรติดสีเดียวทั้งหมด (มักเป็นสีแดง/เขียว)
   
✅ ถ้า LED ติด = ไฟเลี้ยงถูกต้อง
❌ ถ้า LED ไม่ติด = ตรวจสอบสาย 5V, GND หรือ LED เสีย
```

### Test 2: ทดสอบ Data Pin
```
1. ต่อ Data Pin (GPIO 5 → 470Ω → DIN)
2. Upload โค้ดทดสอบ (ดูด้านล่าง)
3. LED ควรเปลี่ยนสีตามโปรแกรม

✅ ถ้า LED เปลี่ยนสี = สำเร็จ!
❌ ถ้า LED ไม่เปลี่ยนสี = ตรวจสอบ Data Pin, Resistor
```

**โค้ดทดสอบ:**
```cpp
#include <FastLED.h>

#define LED_PIN     5
#define NUM_LEDS    60    // ปรับตามจำนวนจริง
#define LED_TYPE    WS2812B
#define COLOR_ORDER GRB

CRGB leds[NUM_LEDS];

void setup() {
  FastLED.addLeds<LED_TYPE, LED_PIN, COLOR_ORDER>(leds, NUM_LEDS);
  FastLED.setBrightness(50);
}

void loop() {
  // สีแดง
  fill_solid(leds, NUM_LEDS, CRGB::Red);
  FastLED.show();
  delay(1000);
  
  // สีเขียว
  fill_solid(leds, NUM_LEDS, CRGB::Green);
  FastLED.show();
  delay(1000);
  
  // สีน้ำเงิน
  fill_solid(leds, NUM_LEDS, CRGB::Blue);
  FastLED.show();
  delay(1000);
}
```

---

## ⚠️ ข้อควรระวัง

### 1. **ทิศทางของ LED Strip**
- ❌ **ผิด**: ต่อ Data เข้าฝั่ง DOUT
- ✅ **ถูก**: ต่อ Data เข้าฝั่ง DIN (มีลูกศรชี้)

### 2. **กราวด์ร่วม (Common Ground)**
- ESP32, Power Supply, และ LED Strip ต้อง**ร่วม GND กัน**
- ไม่ร่วม GND = Data ส่งผ่านไม่ได้

### 3. **ไฟเลี้ยง**
- LED > 60 ดวง = **ต้องใช้ Power Supply แยก**
- **ห้าม** เอาไฟจาก ESP32 ตรงๆ (ไฟไหม้!)

### 4. **การเชื่อมสาย**
- สาย Data ควรสั้น < 30cm
- สายไฟเลี้ยงควรใหญ่ (AWG 18-20)
- บัดกรีให้แน่น หรือใช้ Screw Terminal

### 5. **Capacitor**
- 1000µF ที่ Power Supply (ป้องกันไฟกระชาก)
- 100nF ที่ต้น LED Strip (ถ้าสาย Data ยาว)

---

## 📊 ตารางเลือก Power Supply

| จำนวน LED | กระแสสูงสุด | วัตต์สูงสุด | Power Supply แนะนำ |
|-----------|-------------|-------------|-------------------|
| 30        | 1.8A        | 9W          | 5V 2A             |
| 60        | 3.6A        | 18W         | 5V 5A             |
| 150       | 9A          | 45W         | 5V 10A            |
| 300       | 18A         | 90W         | 5V 20A            |
| 600       | 36A         | 180W        | 5V 40A            |
| 1200      | 72A         | 360W        | 5V 80A            |

> 💡 **หมายเหตุ**: นี่คือค่าสูงสุด (ความสว่าง 100%, สีขาว)  
> การใช้งานจริงมักใช้ไฟ 30-50% ของค่าสูงสุด

---

## 🛒 แนะนำอุปกรณ์ที่ซื้อ

### ร้านออนไลน์ในไทย:
1. **Shopee** - ค้นหา "WS2812B ESP32"
2. **Lazada** - ค้นหา "LED Strip Addressable"
3. **Arduino.in.th** - อุปกรณ์คุณภาพดี
4. **iArduino.in.th** - มีของครบ

### รายการซื้อแนะนำ:
```
□ ESP32 DevKit V1 (150-250 บาท)
□ LED Strip WS2812B 60 LED/m (150-300 บาท/เมตร)
□ Power Supply 5V (ตามจำนวน LED)
  - 5V 10A = ~300 บาท
  - 5V 20A = ~500 บาท
□ Resistor 470Ω (2-5 บาท)
□ Capacitor 1000µF (10-20 บาท)
□ สายไฟ AWG 20 (50-100 บาท/ม้วน)
□ Screw Terminal Block (20-50 บาท)
```

---

## 📞 ต้องการความช่วยเหลือ?

หากมีปัญหาในการเชื่อมต่อ:
1. ถ่ายรูปวงจรของคุณ
2. แจ้งปัญหาที่เจอ
3. เปิด Issue ที่: https://github.com/johnnckr/B2SRGB-Controller/issues

---

**Happy Making! 🎉**
